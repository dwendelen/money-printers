<div class="game">
  <div>
    Welcome {{user.getName()}} to game <span (click)="copyGameIdToClipboard()">{{gameInfo.id}} (click to copy)</span>
    <button (click)="exitGame()">Exit</button>
    <button (click)="logout()">Logout</button>
  </div>
  <div class="column1">
    <div class="board">
      <div class="ground" *ngFor="let ground of game.board">
        <div class="groundOwner">
          <div *ngIf="isGroundUnBuilt(ground)"
               class="unbuilt"
               [style.border-color]="getOwnerColor(ground)"
          ></div>
        </div>
        <div class="groundName"
             [style.background-color]="ground.color"
             (click)="spaceInfo = ground">
          {{ground.text}}
        </div>
        <div class="groundPlayers">
          <div class="playerColor"
               [style.background-color]="player.color"
               *ngFor="let player of getPlayersOn(ground)"
               (click)="demandRent(player.lastDemandId)">
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="column2">
    <div>Total economy: <span id="economy">{{game.economy}}</span></div>
    <div class="playerThing">
      <div class="playerTable">
        <div class="playerTableHeader">
          <div class="playerName">&nbsp;</div>
          <div>Money</div>
          <div>Assets</div>
          <div>Debt</div>
          <div>Start</div>
        </div>
        <div class="playerTableRow" *ngFor="let player of game.players">
          <div class="playerName">
            <div class="playerColor" [style.background-color]="player.color"></div>
            <app-player-name [player]="player"></app-player-name>
            <div *ngIf="player.id === game.gameMasterId" class="gameMaster"></div>
          </div>
          <div class="playerAmount">{{player.money}}</div>
          <div class="playerAmount">{{player.assets}}</div>
          <div class="playerAmount">{{player.debt}}</div>
          <div class="playerAmount"> {{game.getStartMoney(player)}}</div>
        </div>
      </div>
      <div>
        <app-color-selector *ngIf="showJoin()" [disabled]="disableJoin()" [exclude]="getPlayerColors()"
                            (selectedColorChange)="playerColor = $event"></app-color-selector>
        <button class="actionButton" *ngIf="showJoin()" [disabled]="disableJoin()" (click)="join()">Join game</button>
        <button class="actionButton" *ngIf="showStart()" [disabled]="disableStart()" (click)="start()">Start game</button>
      </div>
    </div>
    <div class="actions">
      <button class="actionButton" *ngIf="showRoll()" [disabled]="disableRoll()" (click)="roll()">Roll dice</button>
      <button class="actionButton" *ngIf="showEndTurn()" [disabled]="disableEndTurn()" (click)="endTurn()">End turn</button>
    </div>
    <div class="context">
      <div class="context1">
        <app-buy-this-space
          *ngIf="game.canBuyThis()"
          [space]="game.getMyOwnable()"
          [price]="game.getMyOwnable().getInitialPrice()"
          [maxCash]="game.getMyCash()"
          [disabled]="commandInFlight"
          [canDecline]="true"
          (buy)="buyThis($event.cash, $event.borrowed)"
          (dontBuy)="dontBuyThis()">
        </app-buy-this-space>
      <button *ngIf="game.hasMyRentDemand()" (click)="payRent()">
        Pay {{ game.getPlayer(game.getMyRentDemand().owner).name }} {{game.getMyRentDemand().rent}} rent
      </button>
      <app-bidding
        *ngIf="game.isBidding()"
        [bidding]="getBidding()"
        [disabled]="commandInFlight"
        (pass)="passBid()"
        (bid)="placeBid($event)">
      </app-bidding>
      <app-buy-this-space
        *ngIf="game.hasWonBid()"
        [space]="getBidding().space"
        [price]="getBidding().bid"
        [maxCash]="game.getMyCash()"
        [disabled]="commandInFlight"
        [canDecline]="false"
        (buy)="buyWonBid($event.cash, $event.borrowed)">
      </app-buy-this-space>
      </div>
      <div class="context2">
        <app-space-info *ngIf="spaceInfo" [space]="spaceInfo"></app-space-info>
        <button *ngIf="spaceInfo" (click)="spaceInfo = null">Close</button>
      </div>
    </div>
    <div class="log">
      <app-log [game]="game">
      </app-log>
    </div>
  </div>
</div>
